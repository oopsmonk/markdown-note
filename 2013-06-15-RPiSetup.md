#Raspberry Pi Setup  

##Install Raspbian "wheezy" image  
[Download image from Raspberry Pi offical website](http://www.raspberrypi.org/downloads)  

##Boot from USB Disk  
1. Use [dd][] or [Win32DiskImager][] dump image to both SD card and USB Disk.  
1. Use `gparted` to expand root partition to full USB disk.  
1. Change `cmdline.txt` on sdcard from `root=/dev/mmcblk0p2` to `root=/dev/sda2` 

        dwc_otg.lpm_enable=0 console=ttyAMA0,115200 kgdboc=ttyAMA0,115200 
        console=tty1 root=/dev/sda2 rootfstype=ext4 elevator=deadline rootwait  

1. Plug both sdcard and USB disk into Raspberry Pi, bootup system.  

[dd]: http://en.wikipedia.org/wiki/Dd_(Unix)  
[Win32DiskImager]: http://sourceforge.net/projects/win32diskimager/  

##USB Wifi setup  

###Check USB wifi driver  

```bash
$ sudo lsusb  
Bus 001 Device 002: ID 0424:9512 Standard Microsystems Corp.
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp.
Bus 001 Device 004: ID 0b05:1786 ASUSTek Computer, Inc. USB-N10 802.11n Network Adapter [Realtek RTL8188SU]
Bus 001 Device 005: ID 1a40:0101 Terminus Technology Inc. 4-Port HUB
Bus 001 Device 006: ID 0bc2:5061 Seagate RSS LLC
```  

Here my wifi dongle is [ASUS USB-N10][N10].  
Supported wifi dongle list can find at <http://elinux.org/RPi_VerifiedPeripherals#USB_Wi-Fi_Adapters>   

###Wifi scan test  

```bash
$ sudo iwlist wlan0 scan | grep ESSID  
                ESSID:"CH_Lee"
                ESSID:"iHome01"
                ESSID:"WALL-E"
                ESSID:"AndyStella"
                ESSID:"My home wifi"
                ESSID:"HC-SY"
                ESSID:"default"  
```

###Configure `/etc/network/interfaces`  

```bash
auto wlan0

iface lo inet loopback
iface eth0 inet dhcp

allow-hotplug wlan0
iface wlan0 inet dhcp
wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf
wpa-ssid "XXXXXX"
wpa-psk "YYYYYY"
iface default inet dhcp
```

[N10]: https://www.asus.com/Networking/USBN10/ 

##PPPoE setup  

###Install pppoeconf  

```bash
$ sudo apt-get install pppoeconf  
$ sudo pppoeconf
```  

Input account and password to config PPPoE.  

###Configure static ip to eth0  
* unmark `auto lo`  
* marked `auto eht0` & `auto wlan0`
* config static ip for eth0  

    ```bash
    $ sudo vi /etc/network/interfaces  

    auto lo

    #auto wlan0

    iface lo inet loopback
    iface eth0 inet dhcp

    allow-hotplug wlan0
    iface wlan0 inet dhcp
    wpa-ssid "XXXXXX"
    wpa-psk "YYYYYYY"
    iface default inet dhcp

    auto dsl-provider
    iface dsl-provider inet ppp
    pre-up /sbin/ifconfig eth0 up # line maintained by pppoeconf
    provider dsl-provider

    #auto eth0
    iface eth0 inet static
    address 111.111.111.111 
    netmask 255.255.255.0
    ```  

##exFat support  

Defualt cannot mount exFAT filesystem, why exFAT?  

* NTFS performance is so bad.  
* Single file limited to 4GB in FAT32.

Install exFat:  

    sudo apt-get install exfat-fuse  


##FTP server setup  

###Install vsftpd  

```bash
$ sudo apt-get install vsftpd  
$ sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.bak  
```

###Modify `vsftpd.conf`  

```bash
$ sudo vi /etc/vsftpd.conf  
anonymous_enable=NO
local_enable=YES
write_enable=YES
force_dot_files=YES  #Add at bottom  
```

Invoke configuration  

    $ sudo service vsftpd restart    

Reference:  
<http://www.wikihow.com/Make-a-Raspberry-Pi-Web-Server>  
<http://www.vuplus-community.net/board/threads/howto-make-an-ftp-server-with-your-raspberry.7245/>  
<http://www.instructables.com/id/Raspberry-Pi-Web-Server/step9/Install-an-FTP-server/>  

##BT download server setup  

Install transmission-daemon  

    $ sudo apt-get install transmission-daemon  

Modify config file  

```bash  
$ cd /etc/transmission-daemon  
$ sudo cp settings.json settings.json.bak
$ sudo vi settings.json
#Change download folder
"download-dir": "/home/oopsmonk/BT-Download"
#Accept connection from all ip address
"rpc-whitelist": "*.*.*.*"
#Web GUI login account setting
"rpc-username": "oopsmonk"
"rpc-password": "web-login-pwd"
```

Create download folder and change permission for `debian-transmission` user.

    $ mkdir /home/oopsmonk/BT-Download  
    $ chmod 777 /home/oopsmonk/BT-Download

Reload config  

    $ sudo service transmission-daemon reload  

Login to Web GUI  
<http://localhost:9091/transmission>

##Nginx proxy setup for BT server  

Why should use proxy??  
Some firewall allow connect to internet using 80 port only.  
In this case, we can use proxy redirect 9091 to 80 port.  

```bash 
$ sudo install nginx
$ sudo service nginx stop  
$ sudo vi /etc/nginx/sites-available/default
server{
        #listen   80; ## listen for ipv4; this line is default and implied
        #listen   [::]:80 default_server ipv6only=on; ## listen for ipv6
...
        location /bt {
                proxy_pass http://127.0.0.1:9091/transmission;
        }
...
}

$ sudo service nginx start  
```

Test connection:  
<http://localhost/bt/>  
**Do not forget the `/` in end of URL.**  

Reference:  
[Setting Up Transmission’s Web Interface](http://www.fusionswift.com/2010/07/setting-up-transmissions-web-interface/)  
[Linux防健忘日誌No.69-Ubuntu 12.04 安裝及設定transmission-daemon](http://thkaw.pixnet.net/blog/post/91980843-linux%E9%98%B2%E5%81%A5%E5%BF%98%E6%97%A5%E8%AA%8Cno.69-ubuntu-12.04-%E5%AE%89%E8%A3%9D%E5%8F%8A%E8%A8%AD%E5%AE%9Atransm)  



